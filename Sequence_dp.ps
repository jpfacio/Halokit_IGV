%!PS-Adobe-3.0 EPSF-3.0
%%Creator: ViennaRNA-2.6.2
%%CreationDate: Thu Jul 13 15:40:06 2023
%%Title: RNA Dot Plot
%%BoundingBox: 0 0 700 720
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

% Program options: 

% This file contains the square roots of probabilities in the form
% i  j  sqrt(p(i,j)) ubox

/DPdict 100 dict def

DPdict begin

%%BeginProlog

/logscale false def
/lpmin 1e-05 log def
/DataVisible  [ true true true true] def
/DataTitles   [ false false false false ] def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/box { %size x y box - draws box centered on x,y
   2 index 0.5 mul sub            % x -= 0.5
   exch 2 index 0.5 mul sub exch  % y -= 0.5
   3 -1 roll dup rectfill
} bind def
/ubox {
   logscale {
      log dup add lpmin div 1 exch sub dup 0 lt { pop 0 } if
   } if
   3 1 roll
   exch len exch sub 1 add box
} bind def
/lbox {
   3 1 roll
   len exch sub 1 add box
} bind def
/drawseq { % print sequence along all 4 sides
[ [0.7 -0.3 0 ]
  [0.7 0.7 len add 0]
  [-0.3 len sub -0.4 -90]
  [-0.3 len sub 0.7 len add -90]
] {
   gsave
    aload pop rotate translate
    0 1 len 1 sub {
     dup 0 moveto
     sequence exch 1 getinterval
     show
    } for
   grestore
  } forall
} bind def
/drawgrid{
  gsave
  0.5 dup translate
  0.01 setlinewidth
  len log 0.9 sub cvi 10 exch exp  % grid spacing
  dup 1 gt {
     dup dup 20 div dup 2 array astore exch 40 div setdash
  } { [0.3 0.7] 0.1 setdash } ifelse
  0 exch len {
     dup dup
     0 moveto
     len lineto
     dup
     len exch sub 0 exch moveto
     len exch len exch sub lineto
     stroke
  } for
  [] 0 setdash
  0.04 setlinewidth
  % draw strand separators if required
  currentdict /nicks known {
    gsave
    % draw lines in red color
    0 1 1 sethsbcolor
    % draw with line thickness of 0.2
    0.2 setlinewidth
    nicks
    { 1 sub
    dup dup -1 moveto len 1 add lineto
    len exch sub dup
    -1 exch moveto len 1 add exch lineto
    stroke
    } forall
    grestore
  } if
  % draw diagonal
  0 len moveto len 0 lineto stroke
  grestore
} bind def
/drawTitle {
  currentdict /DPtitle known {
    % center title text
    /Helvetica findfont 10 scalefont setfont
    360 705 moveto DPtitle dup stringwidth pop 2 div neg 0 rmoveto show
  } if
} bind def
/prepareCoords {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      DataSource exch get dup currentdict exch known {
        % data source s_j is present, so find length of array
        currentdict exch get length 
      } { pop 0 } ifelse
    } if
  } for
  exch dup 5 -1 roll add 4 -1 roll dup 5 1 roll 4 -1 roll add max
  len add 3 add 700 exch div dup scale
  exch 1 add exch 1 add translate
} bind def
/utri{ % i j prob utri
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.33
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uUDmotif{ % i j uUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lUDmotif{ % i j lUDmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95 0.6
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uHmotif{ % i j uHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  exch 1 sub dup len exch sub dup 4 -1 roll dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/lHmotif{ % i j lHmotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  dup len exch sub dup 4 -1 roll 1 sub dup 3 1 roll dup len exch sub
  moveto lineto lineto closepath fill
  grestore
} bind def
/uImotif{ % i j k l uImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  1 sub dup 5 1 roll exch len exch sub dup 5 1 roll 3 -1 roll dup
  5 1 roll exch 4 1 roll 3 1 roll exch 1 sub len exch sub dup 3 1 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/lImotif{ % i j k l lImotif
  gsave
  0.5 dup translate
  1 min 2 div
  0.85 mul 0.15 add 0.95  0.99
  3 1 roll % prepare hsb color
  sethsbcolor
  % now produce the coordinates for lines
  4 -1 roll 1 sub dup 5 1 roll exch 1 sub len exch sub dup 3 -1 roll exch
  5 -1 roll len exch sub dup 6 -1 roll dup 3 1 roll 7 4 roll
  moveto lineto lineto lineto closepath fill
  grestore
} bind def
/drawDataSquareBottom { % x v n dataSquareBottom draw box
  len add 2 add exch lbox
} bind def
/drawDataSquareTop { % x v n dataSquareBottom draw box
  neg 1 sub exch lbox
} bind def
/drawDataSquareLeft { % y v n dataSquareBottom draw box
  neg 1 sub 3 1 roll lbox
} bind def
/drawDataSquareRight { % y v n dataSquareBottom draw box
  % use size x y box to draw box
  2 add len add 3 1 roll lbox
} bind def
/drawDataSquareBottomHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  len add 2 add 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareTopHSB { % x v h s b n dataSquareBottomHSB draw box
  % use size x y box to draw box
  neg 1 sub 5 1 roll sethsbcolor lbox
} bind def
/drawDataSquareLeftHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  neg 1 sub 6 1 roll sethsbcolor lbox
} bind def
/drawDataSquareRightHSB { % x v h s b n dataSquareLeftHSB draw box
  % use size x y box to draw box
  2 add len add 6 1 roll sethsbcolor lbox
} bind def
/drawDataTitleBottom {
  /Helvetica findfont 0.95 scalefont setfont
  0 -1.4 3 -1 roll sub moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleTop {
  /Helvetica findfont 0.95 scalefont setfont
  0 len 1.6 add 3 -1 roll add moveto 
  dup stringwidth pop neg 0 rmoveto   
  show
} bind def
/drawDataTitleLeft {
  /Helvetica findfont 0.95 scalefont setfont
  neg 1.4 sub len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
/drawDataTitleRight {
  /Helvetica findfont 0.95 scalefont setfont
  1.6 add len add len 1 add moveto 
  dup stringwidth pop 0 exch rmoveto -90 rotate
  show 90 rotate
} bind def
% do not modify the arrays below unless you know what you're doing!
/DataSource     [ /topData /leftData /bottomData /rightData ] def
/DataDrawBox    [ /drawDataSquareTop  /drawDataSquareLeft /drawDataSquareBottom /drawDataSquareRight] def
/DataDrawBoxHSB [ /drawDataSquareTopHSB /drawDataSquareLeftHSB /drawDataSquareBottomHSB /drawDataSquareRightHSB ] def
/DataDrawTitle  [ /drawDataTitleTop /drawDataTitleLeft /drawDataTitleBottom /drawDataTitleRight ] def
% this is the logic to parse the auxiliary linear data
% given in arrays topData, leftData, bottomData, and rightData
% See also the Boolean arrays DataVisible and DataTitles that
% are used to control which part of data will be visible
/drawData {
  0 1 3 {
    % check whether we want to display current data
    dup DataVisible exch get
    {
      % check whether we've actually got some data
      dup DataSource exch get dup currentdict exch known {
        % data source s_j is present, so we load the
        % corresponding data array a and loop over all data sets a[i]
        currentdict exch get dup length 1 sub 0 1 3 -1 roll {
          dup dup
          % now on stack: j a i i i
          % load data set, i.e. a[i]
          4 -1 roll         % j i i i a
          dup 3 -1 roll get dup % j i i a a[i] a[i]
          % 1. check whether we need to process data set title
          6 -1 roll dup 7 1 roll DataTitles exch get {
            % get current title drawing function key
            6 -1 roll dup 7 1 roll DataDrawTitle exch get
            % now on stack: ... j i i a a[i] a[i] title_draw_key
            % get current title and execute drawing function
            exch 0 get exch currentdict exch get 5 -1 roll exch exec
          } { % remove unused variables
              pop 3 -1 roll pop
          } ifelse
          % now on stack: ... j i a a[i]
          % 2. process actual data a[k] for 1 <= k < n
          dup length 1 sub 1 exch getinterval { 
            % on stack: j i a a[i][k]
            gsave
            dup length 2 eq { % print black box if two-valued
              % get box drawing function
              4 -1 roll dup 5 1 roll DataDrawBox exch get currentdict exch get exch
              aload pop 5 -1 roll dup 6 1 roll 4 -1 roll exec
            } {
              dup length 5 eq { % print box with hsb color
                % get box drawing function
                4 -1 roll dup 5 1 roll DataDrawBoxHSB exch get currentdict exch get exch
                % on stack: j i a f a[i]
                % load data array and prepare for drawing
                aload pop 8 -1 roll dup 9 1 roll 7 -1 roll exec
              } { pop } ifelse
            } ifelse
            grestore
          } forall
          exch pop 
          % left on stack: j a
        } for
        
      } if
    } if
  } for
} bind def

%%EndProlog

/DPtitle {
  (Sequence)
} def

/sequence { (\
GACAGCCACCGCGCGCUCACUGCCACCAAAAGAGUCAUAUCACAGCCGACCAGUUUCUGGAACGUUCCCGAUACUGGAAC\
) } def
/len { sequence length } bind def

% BEGIN linear data array

/topData [
] def

/leftData [
] def

/bottomData [
] def

/rightData [
] def

% END linear data arrays

%Finally, prepare canvas

%draw title
drawTitle

%prepare coordinate system, draw grid and sequence
/Helvetica findfont 0.95 scalefont setfont

%prepare coordinate system
prepareCoords

%draw sequence arround grid
drawseq

%draw grid
drawgrid

%draw auxiliary linear data (if available)
drawData

%data (commands) starts here

%start of quadruplex data

%start of Hmotif data

%start of Imotif data
%start of base pair probability data
1 6 0.033770284 ubox
1 7 0.075928538 ubox
1 9 0.020610279 ubox
1 10 0.051159545 ubox
1 12 0.022296588 ubox
1 14 0.080915058 ubox
1 16 0.047798982 ubox
1 17 0.004341610 ubox
1 18 0.224131831 ubox
1 20 0.055072775 ubox
1 21 0.005274952 ubox
1 23 0.021757872 ubox
1 24 0.038627181 ubox
1 26 0.006093203 ubox
1 27 0.012948706 ubox
1 36 0.606387321 ubox
1 41 0.058620850 ubox
1 43 0.019856111 ubox
1 46 0.016185461 ubox
1 47 0.040515162 ubox
1 50 0.004709449 ubox
1 80 0.014849057 ubox
2 17 0.217274612 ubox
2 21 0.010370201 ubox
2 35 0.606370292 ubox
2 38 0.004484170 ubox
2 40 0.054190006 ubox
3 11 0.027017056 ubox
3 13 0.088548424 ubox
3 15 0.086741829 ubox
3 22 0.053773168 ubox
3 32 0.010228033 ubox
3 34 0.604698356 ubox
3 45 0.028469284 ubox
3 48 0.101577258 ubox
3 59 0.004343734 ubox
3 77 0.005612927 ubox
4 17 0.211283374 ubox
4 21 0.051878943 ubox
4 35 0.003518179 ubox
4 38 0.015477678 ubox
4 40 0.003163430 ubox
4 58 0.004349230 ubox
5 9 0.020419751 ubox
5 10 0.030246514 ubox
5 12 0.438760746 ubox
5 14 0.414229305 ubox
5 16 0.228613376 ubox
5 20 0.048848377 ubox
5 23 0.013089531 ubox
5 24 0.005843530 ubox
5 26 0.003508503 ubox
5 27 0.007378379 ubox
5 35 0.019268057 ubox
5 36 0.010139016 ubox
5 41 0.005357325 ubox
5 43 0.011869593 ubox
5 46 0.171300584 ubox
5 47 0.014338261 ubox
5 57 0.004330584 ubox
5 80 0.008512642 ubox
6 11 0.438128616 ubox
6 13 0.413526170 ubox
6 15 0.228608308 ubox
6 22 0.012810061 ubox
6 32 0.090868834 ubox
6 34 0.020722496 ubox
6 45 0.171408128 ubox
6 48 0.008216750 ubox
6 77 0.005362512 ubox
7 11 0.109900744 ubox
7 13 0.142990053 ubox
7 15 0.011722428 ubox
7 22 0.005476154 ubox
7 32 0.056483412 ubox
7 34 0.004025428 ubox
7 45 0.010826931 ubox
7 48 0.020928942 ubox
7 76 0.004939933 ubox
7 77 0.003453449 ubox
8 17 0.017535579 ubox
8 21 0.005755522 ubox
8 35 0.010811358 ubox
8 40 0.004618698 ubox
8 54 0.004005644 ubox
9 13 0.016049370 ubox
9 15 0.012972580 ubox
9 32 0.006316099 ubox
9 34 0.011362241 ubox
9 45 0.008717407 ubox
9 48 0.061928201 ubox
9 53 0.004051826 ubox
9 77 0.003414667 ubox
10 15 0.025749072 ubox
10 32 0.013107722 ubox
10 34 0.003753911 ubox
10 45 0.006083827 ubox
10 48 0.474166931 ubox
11 16 0.008621470 ubox
11 18 0.005827746 ubox
11 20 0.006515734 ubox
11 23 0.079651119 ubox
11 24 0.090902081 ubox
11 26 0.330436230 ubox
11 27 0.077380092 ubox
11 35 0.010500837 ubox
11 36 0.023320072 ubox
11 38 0.024968540 ubox
11 40 0.021000503 ubox
11 41 0.026796146 ubox
11 43 0.016722074 ubox
11 46 0.115805455 ubox
11 47 0.477468989 ubox
11 50 0.011593039 ubox
11 80 0.005246424 ubox
12 22 0.079995406 ubox
12 32 0.004870373 ubox
12 34 0.011290145 ubox
12 45 0.122475801 ubox
12 48 0.193819587 ubox
13 18 0.008735760 ubox
13 20 0.022392420 ubox
13 21 0.067956586 ubox
13 23 0.256863814 ubox
13 24 0.430921482 ubox
13 26 0.055369270 ubox
13 27 0.049134045 ubox
13 35 0.020623872 ubox
13 36 0.118658007 ubox
13 38 0.037135499 ubox
13 40 0.006561977 ubox
13 41 0.021898877 ubox
13 43 0.029753967 ubox
13 46 0.490388474 ubox
13 47 0.198478032 ubox
13 80 0.005322120 ubox
14 22 0.258423760 ubox
14 32 0.011136383 ubox
14 34 0.021948294 ubox
14 45 0.491090900 ubox
14 48 0.033818584 ubox
15 20 0.064937889 ubox
15 21 0.205857286 ubox
15 23 0.609240713 ubox
15 24 0.036609055 ubox
15 26 0.006955619 ubox
15 27 0.005707021 ubox
15 35 0.570803862 ubox
15 36 0.128483252 ubox
15 38 0.006715439 ubox
15 40 0.007861746 ubox
15 41 0.029549660 ubox
15 43 0.046796231 ubox
15 46 0.213253351 ubox
15 47 0.025975972 ubox
16 22 0.610585819 ubox
16 32 0.025078833 ubox
16 34 0.597544965 ubox
16 45 0.214324419 ubox
16 48 0.005011146 ubox
17 22 0.005288673 ubox
17 25 0.003199841 ubox
17 31 0.024141606 ubox
17 32 0.003207122 ubox
17 33 0.598276104 ubox
17 37 0.025270875 ubox
17 39 0.017762894 ubox
17 42 0.020103552 ubox
17 44 0.205799632 ubox
17 48 0.005340183 ubox
17 49 0.036282333 ubox
18 22 0.008127868 ubox
18 32 0.596738347 ubox
18 34 0.028230560 ubox
18 45 0.003328998 ubox
18 48 0.042764211 ubox
19 35 0.151329799 ubox
19 38 0.017254316 ubox
19 40 0.025140336 ubox
20 32 0.100766266 ubox
20 34 0.159399121 ubox
20 45 0.104316122 ubox
20 48 0.029896445 ubox
21 25 0.005572875 ubox
21 28 0.260162695 ubox
21 29 0.215114761 ubox
21 30 0.122612539 ubox
21 31 0.110161821 ubox
21 32 0.007280183 ubox
21 33 0.158615910 ubox
21 34 0.004476921 ubox
21 37 0.103704797 ubox
21 39 0.051666967 ubox
21 42 0.064742548 ubox
21 44 0.105367046 ubox
21 48 0.009774962 ubox
22 26 0.030030478 ubox
22 27 0.271440653 ubox
22 35 0.068512622 ubox
22 36 0.107633832 ubox
22 38 0.051095984 ubox
22 40 0.007396599 ubox
22 41 0.064987227 ubox
22 43 0.105376375 ubox
22 46 0.048317357 ubox
22 47 0.011050695 ubox
23 32 0.079448161 ubox
23 34 0.094523315 ubox
23 45 0.048447431 ubox
23 48 0.006279421 ubox
23 60 0.005118402 ubox
24 32 0.107225785 ubox
24 34 0.064427136 ubox
24 45 0.009384027 ubox
24 48 0.014565797 ubox
24 59 0.005145436 ubox
25 35 0.163682600 ubox
25 38 0.013970699 ubox
25 40 0.012841150 ubox
25 58 0.004998347 ubox
26 32 0.064742181 ubox
26 34 0.169915424 ubox
26 45 0.010576841 ubox
26 48 0.011262921 ubox
26 60 0.006218854 ubox
26 77 0.003339512 ubox
27 32 0.184760838 ubox
27 34 0.078139506 ubox
27 45 0.014062955 ubox
27 48 0.014067959 ubox
27 59 0.006247545 ubox
27 76 0.003168648 ubox
28 35 0.015152162 ubox
28 38 0.006304193 ubox
28 40 0.005648943 ubox
28 58 0.005935575 ubox
29 35 0.009696313 ubox
29 38 0.010765069 ubox
29 40 0.005751152 ubox
29 56 0.003632053 ubox
30 35 0.011923653 ubox
30 38 0.007990695 ubox
30 40 0.004199348 ubox
30 55 0.003726702 ubox
30 56 0.003893201 ubox
31 35 0.005431618 ubox
31 38 0.020225788 ubox
31 40 0.013957162 ubox
31 54 0.003588743 ubox
31 55 0.004115387 ubox
32 36 0.017292255 ubox
32 38 0.004643046 ubox
32 40 0.003341152 ubox
32 41 0.265231964 ubox
32 43 0.029310881 ubox
32 46 0.011063256 ubox
32 47 0.034552184 ubox
32 51 0.005972448 ubox
32 54 0.003870042 ubox
33 38 0.018938327 ubox
33 40 0.261947404 ubox
34 38 0.006878297 ubox
34 40 0.013567956 ubox
34 41 0.060118777 ubox
34 43 0.102869944 ubox
34 46 0.045168485 ubox
34 47 0.022001358 ubox
34 50 0.038112277 ubox
34 80 0.005297275 ubox
35 39 0.015422131 ubox
35 42 0.097362123 ubox
35 44 0.011273335 ubox
35 45 0.038688301 ubox
35 49 0.050783856 ubox
35 77 0.003280083 ubox
35 79 0.005087446 ubox
36 45 0.039266584 ubox
36 48 0.055744366 ubox
36 76 0.005151614 ubox
37 75 0.005131495 ubox
38 42 0.010983353 ubox
38 44 0.016461109 ubox
38 45 0.015953833 ubox
38 48 0.004670324 ubox
38 49 0.006656963 ubox
38 73 0.006733176 ubox
38 78 0.005051705 ubox
39 72 0.007065736 ubox
40 44 0.012540113 ubox
40 45 0.010349290 ubox
40 48 0.005216742 ubox
40 49 0.231973970 ubox
40 71 0.007098347 ubox
40 78 0.006641578 ubox
41 45 0.014216637 ubox
41 48 0.253588110 ubox
41 60 0.003340315 ubox
41 70 0.007087565 ubox
41 77 0.004434124 ubox
43 48 0.065891603 ubox
43 59 0.003916159 ubox
44 58 0.003916568 ubox
44 66 0.005522577 ubox
45 50 0.004301215 ubox
45 57 0.003870225 ubox
45 65 0.006540840 ubox
45 80 0.027024172 ubox
46 64 0.006420806 ubox
46 77 0.007580842 ubox
47 64 0.006093678 ubox
47 76 0.006839479 ubox
47 77 0.005653112 ubox
48 63 0.007501762 ubox
48 75 0.003387171 ubox
48 80 0.064524770 ubox
50 60 0.026017245 ubox
50 76 0.004769423 ubox
50 77 0.994198541 ubox
51 59 0.026142801 ubox
51 76 0.999480798 ubox
51 77 0.004906836 ubox
52 58 0.026080049 ubox
52 75 0.999325704 ubox
53 57 0.025508842 ubox
53 74 0.999514700 ubox
54 73 0.960149426 ubox
55 70 0.003583047 ubox
55 71 0.022927892 ubox
55 73 0.015057520 ubox
56 70 0.017932850 ubox
56 71 0.973809749 ubox
57 70 0.992444794 ubox
58 70 0.031799862 ubox
58 71 0.003851141 ubox
59 67 0.013522685 ubox
59 68 0.992143495 ubox
59 69 0.113830305 ubox
60 66 0.013371831 ubox
60 67 0.992910347 ubox
60 68 0.111426649 ubox
60 69 0.004569782 ubox
61 65 0.025109903 ubox
61 66 0.928637352 ubox
62 66 0.025859423 ubox
64 80 0.026237635 ubox
65 79 0.026633840 ubox
66 78 0.026850401 ubox
67 77 0.026498438 ubox
68 76 0.026062898 ubox
68 77 0.006719132 ubox
69 76 0.008133770 ubox
70 74 0.012748540 ubox
70 75 0.007093783 ubox
10 48 0.9500000 lbox
11 47 0.9500000 lbox
13 46 0.9500000 lbox
14 45 0.9500000 lbox
15 35 0.9500000 lbox
16 34 0.9500000 lbox
17 33 0.9500000 lbox
18 32 0.9500000 lbox
50 77 0.9500000 lbox
51 76 0.9500000 lbox
52 75 0.9500000 lbox
53 74 0.9500000 lbox
54 73 0.9500000 lbox
56 71 0.9500000 lbox
57 70 0.9500000 lbox
59 68 0.9500000 lbox
60 67 0.9500000 lbox
61 66 0.9500000 lbox
showpage
end
%%EOF
